<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="青春都一餉，忍把浮名換了代碼輕狂。">
<meta property="og:type" content="website">
<meta property="og:title" content="Philip">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Philip">
<meta property="og:description" content="青春都一餉，忍把浮名換了代碼輕狂。">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Philip Zhang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Philip</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Philip</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Philip's blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/05/28/angular-cli/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Philip Zhang">
      <meta itemprop="description" content="青春都一餉，忍把浮名換了代碼輕狂。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Philip">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/05/28/angular-cli/" class="post-title-link" itemprop="url">angular-cli</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2024-05-28 09:34:34 / Modified: 11:26:59" itemprop="dateCreated datePublished" datetime="2024-05-28T09:34:34+08:00">2024-05-28</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Generate-a-new-Angular-project"><a href="#Generate-a-new-Angular-project" class="headerlink" title="Generate a new Angular project"></a>Generate a new Angular project</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng new my-app</span><br></pre></td></tr></table></figure>

<h2 id="Generate-a-new-empty-workspace"><a href="#Generate-a-new-empty-workspace" class="headerlink" title="Generate a new empty workspace"></a>Generate a new empty workspace</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng new my-workspace --create-application=<span class="literal">false</span></span><br></pre></td></tr></table></figure>
<h2 id="Generate-a-new-application-in-the-workspace"><a href="#Generate-a-new-application-in-the-workspace" class="headerlink" title="Generate a new application in the workspace"></a>Generate a new application in the workspace</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> my-workspace</span><br><span class="line">ng generate application shell</span><br></pre></td></tr></table></figure>

<h2 id="Install-package-for-a-specific-project"><a href="#Install-package-for-a-specific-project" class="headerlink" title="Install package for a specific project"></a>Install package for a specific project</h2><p>When you working on a workspace with multiple projects, you can install a package for a specific project.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng add @angular-architects/module-federation --project shell</span><br></pre></td></tr></table></figure>

<h2 id="References"><a href="#References" class="headerlink" title="References:"></a>References:</h2><p><a target="_blank" rel="noopener" href="https://angular.dev/cli">https://angular.dev/cli</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/05/26/angular-module-federation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Philip Zhang">
      <meta itemprop="description" content="青春都一餉，忍把浮名換了代碼輕狂。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Philip">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/05/26/angular-module-federation/" class="post-title-link" itemprop="url">angular-module-federation</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-05-26 11:01:27" itemprop="dateCreated datePublished" datetime="2024-05-26T11:01:27+08:00">2024-05-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-05-28 09:46:05" itemprop="dateModified" datetime="2024-05-28T09:46:05+08:00">2024-05-28</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>This article will introduce Angular Module Federation, a new feature in Webpack 5 that allows you to share code between Angular applications.</p>
<p>Module Federation is a new feature in Webpack 5 that allows you to share code between applications. It enables your application to load remote modules at runtime from another application and share dependencies between applications. This feature is particularly useful for micro-frontends, where you have multiple applications that need to share code.</p>
<h2 id="Steps"><a href="#Steps" class="headerlink" title="Steps"></a>Steps</h2><h3 id="Create-an-empty-angular-workspace"><a href="#Create-an-empty-angular-workspace" class="headerlink" title="Create an empty angular workspace"></a>Create an empty angular workspace</h3><p>Option <code>--no-create-application</code> is used to create an empty workspace without an initial application.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng new angular-module-federation --no-create-application</span><br></pre></td></tr></table></figure>

<h3 id="Generate-shell-application-shell"><a href="#Generate-shell-application-shell" class="headerlink" title="Generate shell application shell"></a>Generate shell application <code>shell</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> angular-module-federation</span><br><span class="line">ng generate application shell</span><br></pre></td></tr></table></figure>

<h3 id="Generate-remote-application-mfe1"><a href="#Generate-remote-application-mfe1" class="headerlink" title="Generate remote application mfe1"></a>Generate remote application <code>mfe1</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng generate application mfe1</span><br></pre></td></tr></table></figure>

<h3 id="Add-plugin-angular-architects-module-federation-to-shell-app"><a href="#Add-plugin-angular-architects-module-federation-to-shell-app" class="headerlink" title="Add plugin @angular-architects/module-federation to shell app"></a>Add plugin <code>@angular-architects/module-federation</code> to <code>shell</code> app</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng add @angular-architects/module-federation --project shell --port 4200 --<span class="built_in">type</span> host</span><br></pre></td></tr></table></figure>

<p>This command will do the following:</p>
<ol>
<li><p>Add <code>@angular-architects/module-federation</code> and <code>ngx-build-plus</code> to file <code>package.json</code> under workspace root.</p>
</li>
<li><p>Add command <code>&quot;run:all&quot;: &quot;node node_modules/@angular-architects/module-federation/src/server/mf-dev-server.js&quot;</code> to <code>scripts</code> section in file <code>package.json</code>. This command will start the module federation development server, which will run app shell and app mfe1 at the same time.</p>
</li>
<li><p>Add file <code>bootstrap.ts</code> under <code>projects/shell/src</code> folder, its content was copied from <code>main.ts</code></p>
 <figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; bootstrapApplication &#125; <span class="keyword">from</span> <span class="string">&#x27;@angular/platform-browser&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; appConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;./app/app.config&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AppComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./app/app.component&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">bootstrapApplication</span>(<span class="title class_">AppComponent</span>, appConfig)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(err));</span><br></pre></td></tr></table></figure></li>
<li><p>Update file <code>projects/shell/src/main.ts</code> to import <code>bootstrap.ts</code>(Note, when a file was imported, it was executed automatically)</p>
 <figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./bootstrap&#x27;</span>;</span><br></pre></td></tr></table></figure></li>
<li><p>Add file <code>webpack.config.js</code> under <code>projects/shell</code> folder, </p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; shareAll, withModuleFederationPlugin &#125; = <span class="built_in">require</span>(<span class="string">&#x27;@angular-architects/module-federation/webpack&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title function_">withModuleFederationPlugin</span>(&#123;</span><br><span class="line"></span><br><span class="line">  <span class="attr">remotes</span>: &#123;</span><br><span class="line">    <span class="string">&quot;mfe1&quot;</span>: <span class="string">&quot;http://localhost:4200/remoteEntry.js&quot;</span>,    </span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">shared</span>: &#123;</span><br><span class="line">    ...<span class="title function_">shareAll</span>(&#123; <span class="attr">singleton</span>: <span class="literal">true</span>, <span class="attr">strictVersion</span>: <span class="literal">true</span>, <span class="attr">requiredVersion</span>: <span class="string">&#x27;auto&#x27;</span> &#125;),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li><p>Add file <code>webpack.prod.config.js</code> under <code>projects/shell</code> folder, </p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="built_in">require</span>(<span class="string">&#x27;./webpack.config&#x27;</span>);</span><br></pre></td></tr></table></figure></li>
<li><p>Update file <code>angular.json</code> under workspace root.</p>
<ol>
<li>projects&#x2F;shell&#x2F;architect&#x2F;build&#x2F;builder: <code>&quot;@angular-devkit/build-angular:application&quot;</code> —&gt; <code>ngx-build-plus:browser</code></li>
<li>projects&#x2F;shell&#x2F;architect&#x2F;build&#x2F;builder&#x2F;extraWebpackConfig: <code>&quot;projects/shell/webpack.config.js&quot;</code></li>
<li>projects&#x2F;shell&#x2F;architect&#x2F;build&#x2F;configurations&#x2F;production&#x2F;extraWebpackConfig: <code>&quot;projects/shell/webpack.prod.config.js&quot;</code></li>
<li>projects&#x2F;shell&#x2F;architect&#x2F;serve&#x2F;configurations&#x2F;extraWebpackConfig: <code>&quot;projects/shell/webpack.prod.config.js&quot;</code></li>
<li>projects&#x2F;shell&#x2F;architect&#x2F;serve&#x2F;options: <figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;options&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"> <span class="attr">&quot;port&quot;</span><span class="punctuation">:</span> <span class="number">4200</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;publicHost&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://localhost:4200&quot;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;extraWebpackConfig&quot;</span><span class="punctuation">:</span> <span class="string">&quot;projects/shell/webpack.config.js&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<p>Note that: <code>extraWebpackConfig</code> is an option from <a target="_blank" rel="noopener" href="https://github.com/manfredsteyer/ngx-build-plus/"><code>ngx-build-plus</code></a>, it allows you to add additional webpack configuration to the project.</p>
<h3 id="Add-plugin-angular-architects-module-federation-to-mfe1-app"><a href="#Add-plugin-angular-architects-module-federation-to-mfe1-app" class="headerlink" title="Add plugin @angular-architects/module-federation to mfe1 app"></a>Add plugin <code>@angular-architects/module-federation</code> to <code>mfe1</code> app</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng add @angular-architects/module-federation --project mfe1 --port 4201 --<span class="built_in">type</span> remote</span><br></pre></td></tr></table></figure>

<p>This command will do the same thing as the previous command, but for the <code>mfe1</code> app with a little difference.</p>
<ol>
<li>webpack.config.js <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; shareAll, withModuleFederationPlugin &#125; = <span class="built_in">require</span>(<span class="string">&#x27;@angular-architects/module-federation/webpack&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title function_">withModuleFederationPlugin</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;mfe1&#x27;</span>,</span><br><span class="line">  <span class="attr">exposes</span>: &#123;</span><br><span class="line">    <span class="string">&#x27;./Component&#x27;</span>: <span class="string">&#x27;./projects/mfe1/src/app/app.component.ts&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">shared</span>: &#123;</span><br><span class="line">    ...<span class="title function_">shareAll</span>(&#123; <span class="attr">singleton</span>: <span class="literal">true</span>, <span class="attr">strictVersion</span>: <span class="literal">true</span>, <span class="attr">requiredVersion</span>: <span class="string">&#x27;auto&#x27;</span> &#125;),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Serve options in <code>angular.json</code> <figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;options&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;port&quot;</span><span class="punctuation">:</span> <span class="number">4201</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;publicHost&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://localhost:4201&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;extraWebpackConfig&quot;</span><span class="punctuation">:</span> <span class="string">&quot;projects/mfe1/webpack.config.js&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="Add-home-component-to-shell-app"><a href="#Add-home-component-to-shell-app" class="headerlink" title="Add home component to shell app"></a>Add <code>home</code> component to <code>shell</code> app</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng generate component home --project=shell</span><br></pre></td></tr></table></figure>

<h3 id="Add-product-component-to-mfe1-app"><a href="#Add-product-component-to-mfe1-app" class="headerlink" title="Add product component to mfe1 app"></a>Add <code>product</code> component to <code>mfe1</code> app</h3><p>app <code>mfe1</code> will expose a component <code>product</code> to shell app.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng generate component product --project=mfe1</span><br></pre></td></tr></table></figure>

<h3 id="Update-webpack-config-js-in-app-mfe1"><a href="#Update-webpack-config-js-in-app-mfe1" class="headerlink" title="Update webpack.config.js in app mfe1"></a>Update webpack.config.js in app mfe1</h3><p>We’ll expose the <code>product</code> component to the <code>shell</code> app.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; shareAll, withModuleFederationPlugin &#125; = <span class="built_in">require</span>(<span class="string">&#x27;@angular-architects/module-federation/webpack&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title function_">withModuleFederationPlugin</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;mfe1&#x27;</span>,</span><br><span class="line">  <span class="attr">exposes</span>: &#123;</span><br><span class="line">    <span class="string">&#x27;./Component&#x27;</span>: <span class="string">&#x27;./projects/mfe1/src/app/product/product.component.ts&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">shared</span>: &#123;</span><br><span class="line">    ...<span class="title function_">shareAll</span>(&#123; <span class="attr">singleton</span>: <span class="literal">true</span>, <span class="attr">strictVersion</span>: <span class="literal">true</span>, <span class="attr">requiredVersion</span>: <span class="string">&#x27;auto&#x27;</span> &#125;),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Update-app-routers-ts-in-app-mfe1"><a href="#Update-app-routers-ts-in-app-mfe1" class="headerlink" title="Update app.routers.ts in app mfe1"></a>Update app.routers.ts in app mfe1</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">routes</span>: <span class="title class_">Routes</span> = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;product&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">ProductComponent</span>,</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<h3 id="Update-app-routes-ts-in-app-shell"><a href="#Update-app-routes-ts-in-app-shell" class="headerlink" title="Update app.routes.ts in app shell"></a>Update app.routes.ts in app shell</h3><p>Add a route path <code>product</code> to load the <code>product</code> component.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">routes</span>: <span class="title class_">Routes</span> = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;home&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">HomeComponent</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;product&#x27;</span>,</span><br><span class="line">    <span class="attr">loadChildren</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;mfe1/Component&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">m</span> =&gt;</span> m.<span class="property">ProductComponent</span>),</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<h3 id="Add-typescript-declaration-file-decl-d-ts-under-projects-x2F-shell-x2F-src"><a href="#Add-typescript-declaration-file-decl-d-ts-under-projects-x2F-shell-x2F-src" class="headerlink" title="Add typescript declaration file decl.d.ts under projects&#x2F;shell&#x2F;src"></a>Add typescript declaration file <code>decl.d.ts</code> under projects&#x2F;shell&#x2F;src</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="variable language_">module</span> <span class="string">&#x27;mfe1/Component&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Workspace-structure"><a href="#Workspace-structure" class="headerlink" title="Workspace structure"></a>Workspace structure</h3><p>Here is the file structure of the workspace.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">angular-module-federation/</span><br><span class="line">├─ projects/</span><br><span class="line">│  ├─ mfe1/</span><br><span class="line">│  │  ├─ src/</span><br><span class="line">│  │  ├─ webpack.config.js</span><br><span class="line">│  │  ├─ webpack.prod.config.js</span><br><span class="line">│  ├─ shell/</span><br><span class="line">│  │  ├─ src/</span><br><span class="line">│  │  ├─ webpack.config.js</span><br><span class="line">│  │  ├─ webpack.prod.config.js</span><br><span class="line">├─ angular.json</span><br><span class="line">├─ package.json</span><br></pre></td></tr></table></figure>

<h3 id="Start-the-development-server"><a href="#Start-the-development-server" class="headerlink" title="Start the development server"></a>Start the development server</h3><p>You can run shell and mef1 app separately by running the following command.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ng serve shell - o</span><br><span class="line">ng serve mfe1 - o</span><br></pre></td></tr></table></figure>

<p>Or run them at the same time by running the following command.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run run:all</span><br></pre></td></tr></table></figure>

<p>Change the shell app url in browser to <code>localhost:4200/product</code>, you will see the product component from mfe1 app.</p>
<h3 id="Remote-entry-file"><a href="#Remote-entry-file" class="headerlink" title="Remote entry file"></a>Remote entry file</h3><p>If you look into the webpack.config.js file in the <code>shell</code> app, you will see the following configuration.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">remotes</span>: &#123;</span><br><span class="line">  <span class="string">&quot;mfe1&quot;</span>: <span class="string">&quot;http://localhost:4200/remoteEntry.js&quot;</span>,    </span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>Here we use <code>remoteEntry.js</code> as the entry point of the remote expose module, this is the default file name, However, if you want to change it, you can update the configuration in the webpack.config.js file in the <code>mfe1</code> app.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title function_">withModuleFederationPlugin</span>(&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="attr">filename</span>: <span class="string">&#x27;xxx.js&#x27;</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>and then update the configuration in the webpack.config.js file in the <code>shell</code> app.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title function_">withModuleFederationPlugin</span>(&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="attr">remotes</span>: &#123;</span><br><span class="line">    <span class="string">&quot;mfe1&quot;</span>: <span class="string">&quot;http://localhost:4200/xxx.js&quot;</span>,    </span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>You can found the options of <code>withModuleFederationPlugin</code> in WebPack’s official documentation <a target="_blank" rel="noopener" href="https://webpack.js.org/plugins/module-federation-plugin/#options">here</a>, unfortunately, some property was even not mentioned in this document, you can found them in the source code of the plugin(schema file) from <a target="_blank" rel="noopener" href="https://github.com/webpack/webpack/blob/main/schemas/plugins/container/ModuleFederationPlugin.json">here</a></p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li>Mono repo with Angular CLI: <a target="_blank" rel="noopener" href="https://angular.dev/reference/configs/file-structure#multiple-projects">https://angular.dev/reference/configs/file-structure#multiple-projects</a></li>
<li>Module federation with Angular: <a target="_blank" rel="noopener" href="https://module-federation.io/practice/frameworks/angular/angular-cli.html">https://module-federation.io/practice/frameworks/angular/angular-cli.html</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/manfredsteyer/ngx-build-plus/">https://github.com/manfredsteyer/ngx-build-plus/</a></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/05/25/typescript-paths/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Philip Zhang">
      <meta itemprop="description" content="青春都一餉，忍把浮名換了代碼輕狂。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Philip">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/05/25/typescript-paths/" class="post-title-link" itemprop="url">typescript-paths</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2024-05-25 08:59:36 / Modified: 21:54:41" itemprop="dateCreated datePublished" datetime="2024-05-25T08:59:36+08:00">2024-05-25</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p><code>paths</code> is a TypeScript configuration option that allows you to map a module name to a path. This is useful when you have a complex project structure and you want to avoid long relative paths.</p>
<h2 id="Config"><a href="#Config" class="headerlink" title="Config"></a>Config</h2><p>Add the following configuration to your <code>tsconfig.json</code> file.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;@app/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;src/app/*&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;@shared/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;src/shared/*&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;@utils/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;src/app/service/others/utils/*&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><p>Suppose you have a file <code>stringUtils.ts</code> in the <code>src/app/service/others/utils</code> directory. You can import it like this:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;stringUtils&#125; <span class="keyword">from</span> <span class="string">&#x27;@utils/stringUtils&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>You don’t need to write the long relative path. TypeScript will automatically resolve the path based on the configuration in <code>tsconfig.json</code>.</p>
<h2 id="Nx-mono-repo"><a href="#Nx-mono-repo" class="headerlink" title="Nx mono repo"></a>Nx mono repo</h2><p>When using Nx mono repo to create multiple app&#x2F;libs, be careful when you use <code>paths</code> in <code>tsconfig.json</code>. You need to add the <code>paths</code> configuration to the <code>tsconfig.base.json</code> file in the root directory of the Nx workspace. and every tsconfig.json in each app&#x2F;lib should extend the <code>tsconfig.base.json</code>.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tsconfig.json in app or lib</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;extends&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../tsconfig.base.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;outDir&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../dist/out-tsc&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;types&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;include&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;**/*.ts&quot;</span><span class="punctuation">,</span> <span class="string">&quot;**/*.tsx&quot;</span><span class="punctuation">,</span> <span class="string">&quot;**/*.js&quot;</span><span class="punctuation">,</span> <span class="string">&quot;**/*.jsx&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tsconfig.base.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;@app/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;apps/*&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;@shared/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;libs/shared/*&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;@utils/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;libs/shared/utils/*&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>Note that the <code>tsconfig.json</code> in app&#x2F;lib has higher priority than the <code>tsconfig.base.json</code>. If you have the same configuration in both files, the configuration in <code>tsconfig.json</code> will override the configuration in <code>tsconfig.base.json</code>. this will cause some path not found sometimes.</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p><a target="_blank" rel="noopener" href="https://www.typescriptlang.org/tsconfig/#paths">https://www.typescriptlang.org/tsconfig/#paths</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/05/21/angular-ngc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Philip Zhang">
      <meta itemprop="description" content="青春都一餉，忍把浮名換了代碼輕狂。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Philip">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/05/21/angular-ngc/" class="post-title-link" itemprop="url">angular-ngc</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2024-05-21 19:41:51 / Modified: 21:53:08" itemprop="dateCreated datePublished" datetime="2024-05-21T19:41:51+08:00">2024-05-21</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="What-is-angular-ngc"><a href="#What-is-angular-ngc" class="headerlink" title="What is angular ngc?"></a>What is angular ngc?</h2><p>ngc stands fore Angular Compiler. It is a tool that compiles Angular applications. ngc was built on tsc(TypeScript Compiler) and extends it to support Angular.</p>
<h2 id="Angular-compile-options"><a href="#Angular-compile-options" class="headerlink" title="Angular compile options"></a>Angular compile options</h2><p>You can see the ngc compile options in the tsconfig.json file under your Angular project root.</p>
<p>We can see that the output directory is set to dist&#x2F;out-tsc. and there is a special section <code>angularCompilerOptions</code> used for angular.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compileOnSave&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;outDir&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./dist/out-tsc&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;strict&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    ...</span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;angularCompilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;enableI18nLegacyMessageIdFormat&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;strictInjectionParameters&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;strictInputAccessModifiers&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;strictTemplates&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Run-ngc-manually"><a href="#Run-ngc-manually" class="headerlink" title="Run ngc manually"></a>Run <code>ngc</code> manually</h2><p>You can run <code>ngc</code> manually by using the command <code>ngc</code> in the terminal. and then found the compiled files in the dist&#x2F;out-tsc directory.</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p><a target="_blank" rel="noopener" href="https://blog.angular.io/how-the-angular-compiler-works-42111f9d2549">https://blog.angular.io/how-the-angular-compiler-works-42111f9d2549</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/05/19/angular-service/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Philip Zhang">
      <meta itemprop="description" content="青春都一餉，忍把浮名換了代碼輕狂。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Philip">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/05/19/angular-service/" class="post-title-link" itemprop="url">angular-service</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2024-05-19 16:06:46 / Modified: 16:32:19" itemprop="dateCreated datePublished" datetime="2024-05-19T16:06:46+08:00">2024-05-19</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Angular-Service"><a href="#Angular-Service" class="headerlink" title="Angular Service"></a>Angular Service</h2><p>在Angular中，<code>Service</code>是一个可注入的类，用于封装可重用的功能。<code>Service</code>可以在任何<code>Component</code>中使用，也可以用于其他<code>Service</code>。</p>
<p>Service可以完成以下工作，很多和UI无关的操作都可以用Service来完成，这样可以保持<code>Component</code>的简洁。</p>
<ul>
<li>调用API获取后台数据</li>
<li>验证用户输入</li>
<li>日志服务</li>
<li>数据库操作</li>
</ul>
<h2 id="创建Service"><a href="#创建Service" class="headerlink" title="创建Service"></a>创建Service</h2><p>使用Angular CLI创建Service，下面的CLI命令生成一个<code>OrderService</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng generate service order</span><br></pre></td></tr></table></figure>
<p>该命令会在项目根目录下生成一个<code>order.service.ts</code>文件，我们在其中添加一个<code>getOrder</code>方法，用于获取订单信息。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// order.service.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Injectable</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@angular/core&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Order</span>&#125; <span class="keyword">from</span> <span class="string">&quot;./Order&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Injectable</span>(&#123;</span><br><span class="line">  <span class="attr">providedIn</span>: <span class="string">&#x27;root&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123; &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getOrder</span>():<span class="title class_">Promise</span>&lt;<span class="title class_">Order</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(&#123;</span><br><span class="line">          <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;Order 1&#x27;</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;, <span class="number">1000</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Order定义如下</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// order.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">Order</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到，<code>OrderService</code>对应的Class是用<code>@Injectable</code>装饰器修饰的，这样Angular就可以将其注入到<code>Component</code>中。我们还给<code>@Injectable</code>传递了一个参数<code>providedIn: &#39;root&#39;</code>，这表示该Service是一个全局Service，可以在整个Application中使用。</p>
<h2 id="使用Service"><a href="#使用Service" class="headerlink" title="使用Service"></a>使用Service</h2><p>在<code>ProductComponent</code>中使用<code>OrderService</code>，我们需要在<code>ProductComponent</code>的构造函数中注入<code>OrderService</code>，然后调用<code>OrderService</code>的方法。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">OrderService</span>&#125; <span class="keyword">from</span> <span class="string">&quot;../order.service&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Order</span>&#125; <span class="keyword">from</span> <span class="string">&quot;../Order&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">ProductComponent</span> <span class="keyword">implements</span> <span class="title class_">OnInit</span> &#123;</span><br><span class="line">  <span class="attr">order</span>: <span class="title class_">Order</span> | <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// inject OrderService</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> orderService: OrderService</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">order</span> = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">ngOnInit</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">order</span> = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">orderService</span>.<span class="title function_">getOrder</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">order</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="providedIn-vs-providers"><a href="#providedIn-vs-providers" class="headerlink" title="providedIn vs providers"></a>providedIn vs providers</h2><p>在Angular中，我们可以使用<code>providedIn</code>或者<code>providers</code>来指定Service的提供范围。<code>providedIn</code>是Angular 6中引入的新特性，用于替代<code>providers</code>。</p>
<p>如果在定义Service时指定了<code>providedIn: &#39;root&#39;</code>，那么Angular会在应用启动时自动将该Service注入到根模块中，这样就可以在整个应用中使用该Service。在使用该Service的Component中，就不必再在<code>providers</code>中声明该Service。</p>
<p>如果定义Service时没有指定<code>providedIn</code>，那么就需要在使用该Service的Component中的<code>providers</code>中声明该Service。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  <span class="attr">selector</span>: <span class="string">&#x27;app-product&#x27;</span>,</span><br><span class="line">  <span class="attr">standalone</span>: <span class="literal">true</span>,</span><br><span class="line"> </span><br><span class="line">  <span class="attr">templateUrl</span>: <span class="string">&#x27;./product.component.html&#x27;</span>,</span><br><span class="line">  <span class="attr">styleUrl</span>: <span class="string">&#x27;./product.component.css&#x27;</span>,</span><br><span class="line">  <span class="attr">providers</span>: [<span class="title class_">OrderService</span>] <span class="comment">// &lt;--- provide service here</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>当Angular找不到一个Service的提供者时，会抛出一个错误，相信大家都见过这个错误，从下面的错误可知，<code>_OrderService</code>没有提供者。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ERROR Error [NullInjectorError]: R3InjectorError(Environment Injector)[_OrderService -&gt; _OrderService]: </span><br><span class="line">  NullInjectorError: No provider <span class="keyword">for</span> _OrderService!</span><br></pre></td></tr></table></figure>

<p>更进一步，我们可以将Service的使用范围限定在某个Component中，这样其他Component就无法使用该Service。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// order.service.ts</span></span><br><span class="line"><span class="meta">@Injectable</span>(&#123;</span><br><span class="line">  <span class="attr">providedIn</span>: <span class="title class_">ProductComponent</span>, <span class="comment">// --- only available in ProductComponent</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>，以上代码无法在应用启动时自动注入Service，使用者仍然需要在<code>providers</code>中声明该Service。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// product.component.ts</span></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  <span class="attr">selector</span>: <span class="string">&#x27;app-product&#x27;</span>,</span><br><span class="line">  <span class="attr">standalone</span>: <span class="literal">true</span>,</span><br><span class="line"> </span><br><span class="line">  <span class="attr">templateUrl</span>: <span class="string">&#x27;./product.component.html&#x27;</span>,</span><br><span class="line">  <span class="attr">styleUrl</span>: <span class="string">&#x27;./product.component.css&#x27;</span>,</span><br><span class="line">  <span class="attr">providers</span>: [<span class="title class_">OrderService</span>] <span class="comment">// &lt;--- provide service here</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>如果在其他Component中尝试使用该Service，会抛出一个错误，如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR TypeError: Cannot <span class="built_in">read</span> properties of undefined (reading <span class="string">&#x27;provide&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Service的Scope"><a href="#Service的Scope" class="headerlink" title="Service的Scope"></a>Service的Scope</h2><h3 id="providedIn-‘root’"><a href="#providedIn-‘root’" class="headerlink" title="providedIn: ‘root’"></a>providedIn: ‘root’</h3><p><code>providedIn: &#39;root&#39;</code>表示Service是一个全局Service，可以在整个应用中使用。Angular会在应用启动时自动将该Service注入到根模块中。</p>
<h3 id="providedIn-‘platform’"><a href="#providedIn-‘platform’" class="headerlink" title="providedIn: ‘platform’"></a>providedIn: ‘platform’</h3><p><code>providedIn: &#39;platform&#39;</code>表示Service是一个平台Service，可以在整个应用中使用。Angular会在应用启动时自动将该Service注入到平台模块中。</p>
<h3 id="providedIn-‘any’"><a href="#providedIn-‘any’" class="headerlink" title="providedIn: ‘any’"></a>providedIn: ‘any’</h3><p><code>providedIn: &#39;any&#39;</code>表示Service是一个局部Service，只能在指定的Component中使用。Angular不会自动将该Service注入到任何模块中，使用者需要在<code>providers</code>中声明该Service。</p>
<h2 id="lazy-loading与Service实例"><a href="#lazy-loading与Service实例" class="headerlink" title="lazy loading与Service实例"></a>lazy loading与Service实例</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/05/18/angular-pipe/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Philip Zhang">
      <meta itemprop="description" content="青春都一餉，忍把浮名換了代碼輕狂。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Philip">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/05/18/angular-pipe/" class="post-title-link" itemprop="url">angular-pipe</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-05-18 21:45:34" itemprop="dateCreated datePublished" datetime="2024-05-18T21:45:34+08:00">2024-05-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-05-29 21:56:57" itemprop="dateModified" datetime="2024-05-29T21:56:57+08:00">2024-05-29</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="What-is-a-pipe"><a href="#What-is-a-pipe" class="headerlink" title="What is a pipe"></a>What is a pipe</h2><p>Angular中的pipe就是一个简单的函数，该函数接收一个输入值，然后返回一个转换后的值。pipe只需在一处定义，然后任意模板都可使用。</p>
<h2 id="Generate-pipe"><a href="#Generate-pipe" class="headerlink" title="Generate pipe"></a>Generate pipe</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng generate pipe full-name</span><br></pre></td></tr></table></figure>

<p>This will create a new file <code>full-name.pipe.ts</code> in the <code>src/app</code> folder.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Pipe</span>, <span class="title class_">PipeTransform</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@angular/core&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="attr">firstName</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">lastName</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Pipe</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;fullName&#x27;</span>,</span><br><span class="line">  <span class="attr">standalone</span>: <span class="literal">true</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">FullNamePipe</span> <span class="keyword">implements</span> <span class="title class_">PipeTransform</span> &#123;</span><br><span class="line">  <span class="title function_">transform</span>(<span class="attr">value</span>: <span class="title class_">Person</span>, ...<span class="attr">args</span>: <span class="built_in">unknown</span>[]): <span class="built_in">unknown</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> value.<span class="property">lastName</span> + <span class="string">&#x27;, &#x27;</span> + value.<span class="property">firstName</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>用@Pipe装饰器来定义pipe，<code>name</code>属性是pipe的名字，<code>standalone</code>属性是可选的，如果设置为<code>true</code>，则表示该pipe是一个独立的pipe，不依赖于任何Module。<code>pure</code>参数是可选的，默认为true。pure pipe只有当输入变化时才重新计算。</p>
<p>每个Pipe都实现了<code>PipeTransform</code>接口，该接口只有一个方法<code>transform</code>，该方法接收一个输入值和一些可选参数，然后返回一个转换后的值。在这里，我们根据输入的Person变量，返回对应的全名。</p>
<h2 id="How-to-use-pipe"><a href="#How-to-use-pipe" class="headerlink" title="How to use pipe"></a>How to use pipe</h2><p>在component中引入pipe，然后在模板中使用。上面的FullNamePipe可以这样使用：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// component.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">FullNamePipe</span>&#125; <span class="keyword">from</span> <span class="string">&quot;../full-name.pipe&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="attr">imports</span>: [</span><br><span class="line">    <span class="title class_">FullNamePipe</span>,</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">person = &#123;</span><br><span class="line">  <span class="attr">firstName</span>: <span class="string">&#x27;Philip&#x27;</span>,</span><br><span class="line">  <span class="attr">lastName</span>: <span class="string">&#x27;Zhang&#x27;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- component.html --&gt;</span></span><br><span class="line">&#123;&#123; person | fullName &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>也可以直接在代码中使用pipe：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">FullNamePipe</span> &#125; <span class="keyword">from</span> <span class="string">&quot;../full-name.pipe&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">YourComponent</span> &#123;</span><br><span class="line">  person = &#123;</span><br><span class="line">    <span class="attr">firstName</span>: <span class="string">&#x27;Philip&#x27;</span>,</span><br><span class="line">    <span class="attr">lastName</span>: <span class="string">&#x27;Zhang&#x27;</span>,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> fullNamePipe: FullNamePipe</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> fullName = <span class="variable language_">this</span>.<span class="property">fullNamePipe</span>.<span class="title function_">transform</span>(<span class="variable language_">this</span>.<span class="property">person</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(fullName); <span class="comment">// logs &quot;Zhang, Philip&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Naming-convention"><a href="#Naming-convention" class="headerlink" title="Naming convention"></a>Naming convention</h2><ol>
<li><code>pipe</code> name should be in <code>camelCase</code>. - <code>fullName</code></li>
<li><code>pipe</code> class should be in <code>PascalCase</code> and end with <code>Pipe</code>. - <code>FullNamePipe</code></li>
</ol>
<h2 id="Pass-parameter-to-pipe"><a href="#Pass-parameter-to-pipe" class="headerlink" title="Pass parameter to pipe"></a>Pass parameter to pipe</h2><p>pipe可以接收多个参数，参数之间使用<code>:</code>分隔。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; value | pipe:param1:param2... &#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Pipe-chaining"><a href="#Pipe-chaining" class="headerlink" title="Pipe chaining"></a>Pipe chaining</h2><p>多个pipe可以使用<code>|</code>符号连接在一起，前一个pipe的输出会作为后一个pipe的输入。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; value | pipe1 | pipe2 | pipe3 &#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Pipe-precedence"><a href="#Pipe-precedence" class="headerlink" title="Pipe precedence"></a>Pipe precedence</h2><p>pipe的执行顺序是从左到右，并且pipe的优先级高于 :?操作符.</p>
<p>Bad</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; value &gt; 0 ? expression1 : expression2 | pipe &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>is equal to</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; value &gt; 0 ? expression1 : (expression2 | pipe) &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>Good</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; (value &gt; 0 ? expression1 : expression2) | pipe &#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p><a target="_blank" rel="noopener" href="https://angular.io/guide/pipes-custom-data-trans">https://angular.io/guide/pipes-custom-data-trans</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/05/14/useful-commands/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Philip Zhang">
      <meta itemprop="description" content="青春都一餉，忍把浮名換了代碼輕狂。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Philip">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/05/14/useful-commands/" class="post-title-link" itemprop="url">useful-commands</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2024-05-14 21:34:28 / Modified: 21:59:07" itemprop="dateCreated datePublished" datetime="2024-05-14T21:34:28+08:00">2024-05-14</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h1><h3 id="1-merge-main-branch-to-current-branch"><a href="#1-merge-main-branch-to-current-branch" class="headerlink" title="1. merge main branch to current branch"></a>1. merge main branch to current branch</h3><p>This is very useful when you work on a branch for a long time, and every day before you start coding, you sync your branch with <code>main</code> branch.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull origin main</span><br></pre></td></tr></table></figure>

<h3 id="2-checkout-remote-branch"><a href="#2-checkout-remote-branch" class="headerlink" title="2. checkout remote branch"></a>2. checkout remote branch</h3><p>Before checking out a remote branch, you need to fetch the remote branch first.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git fetch</span><br><span class="line">git checkout -b local-branch-name origin/remote-branch-name</span><br></pre></td></tr></table></figure>

<h1 id="NPM"><a href="#NPM" class="headerlink" title="NPM"></a>NPM</h1><h3 id="1-npm-install-error"><a href="#1-npm-install-error" class="headerlink" title="1. npm install error"></a>1. npm install error</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">code ERESOLVE</span><br><span class="line">npm ERR! ERESOLVE could not resolve</span><br><span class="line">npm ERR! </span><br><span class="line">npm ERR! While resolving: karma-jasmine-html-reporter@1.6.0</span><br><span class="line">npm ERR! Found: jasmine-core@3.6.0</span><br></pre></td></tr></table></figure>
<p>This is caused by dependency conflict, you can try to install the package with <code>--force</code> or <code>--legacy-peer-deps</code> flag. see <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/64573177/unable-to-resolve-dependency-tree-error-when-installing-npm-packages">here</a> for more details.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --force</span><br></pre></td></tr></table></figure>
<p>or</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --legacy-peer-deps</span><br></pre></td></tr></table></figure>



<h1 id="Yarn"><a href="#Yarn" class="headerlink" title="Yarn"></a>Yarn</h1><h1 id="Nx"><a href="#Nx" class="headerlink" title="Nx"></a>Nx</h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/05/11/angular-auxiliary-secondary-router/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Philip Zhang">
      <meta itemprop="description" content="青春都一餉，忍把浮名換了代碼輕狂。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Philip">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/05/11/angular-auxiliary-secondary-router/" class="post-title-link" itemprop="url">angular-auxiliary-secondary-router</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-05-11 12:37:35" itemprop="dateCreated datePublished" datetime="2024-05-11T12:37:35+08:00">2024-05-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-05-20 19:46:05" itemprop="dateModified" datetime="2024-05-20T19:46:05+08:00">2024-05-20</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Angular对路由的支持非常强大，可以实现多种路由模式，本文主要介绍辅助路由。</p>
<h2 id="辅助路由"><a href="#辅助路由" class="headerlink" title="辅助路由"></a>辅助路由</h2><p>辅助路由（auxiliary route）是一种特殊的路由，它的主要应用场景是为当前页面添加弹窗，主路由和辅助路由对应的组件同时显示，当关闭辅助路由组件（弹窗）时，主路由仍然保持显示。</p>
<h2 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h2><h3 id="创建Project"><a href="#创建Project" class="headerlink" title="创建Project"></a>创建Project</h3><p>首先参考<a target="_blank" rel="noopener" href="https://zdd.github.io/2024/05/05/angular-how-to-create-an-angular-app/">这篇</a>创建一个Angular项目。注意从<code>Angular 17</code>开始，默认就使用<code>Standalone Component</code>来创建组件了，不在使用<code>NgModule</code>了。</p>
<h3 id="添加路由配置"><a href="#添加路由配置" class="headerlink" title="添加路由配置"></a>添加路由配置</h3><p>打开<code>app.routes.ts</code>文件，添加路由配置：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">routes</span>: <span class="title class_">Routes</span> = [</span><br><span class="line">  &#123;<span class="attr">path</span>: <span class="string">&#x27;book&#x27;</span>, <span class="attr">component</span>: <span class="title class_">BookComponent</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">path</span>: <span class="string">&#x27;book-detail&#x27;</span>, <span class="attr">outlet</span>: <span class="string">&#x27;detail&#x27;</span>, <span class="attr">component</span>: <span class="title class_">BookDetailComponent</span>&#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<h3 id="添加router-outlet"><a href="#添加router-outlet" class="headerlink" title="添加router-outlet"></a>添加<code>router-outlet</code></h3><p>在<code>app.component.html</code>文件中添加<code>router-outlet</code>：从Angular17开始，可以使用自关闭组件了，也就是说<code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code>可以简化为<code>&lt;router-outlet /&gt;</code>，注意第二个<code>outlet</code>添加了<code>name</code>属性，用来给<code>outlet</code>命名。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-outlet</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-outlet</span> <span class="attr">name</span>=<span class="string">&quot;detail&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="添加book组件"><a href="#添加book组件" class="headerlink" title="添加book组件"></a>添加<code>book</code>组件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng generate component book</span><br></pre></td></tr></table></figure>

<p>在<code>book</code>组件的模板文件中添加一个按钮，点击按钮时显示<code>book-detail</code>组件：</p>
<p>打开<code>book.component.html</code>，添加如下代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>book works!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">&quot;openBookDetail()&quot;</span>&gt;</span>Book Detail<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>打开<code>book.component.ts</code>，添加按钮点击事件处理函数，这里调用<code>navigate</code>方法来实现路由跳转。注意该方法的第一个参数是数组，如果要跳转到命名的<code>outlet</code>, 则格式为：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&#123;<span class="attr">outlets</span>: &#123;outlet-<span class="attr">name</span>: <span class="string">&#x27;path-name&#x27;</span>&#125;&#125;]</span><br></pre></td></tr></table></figure>
<p>以下代码中： <code>detail</code>为命名的<code>outlet</code>，<code>book-detail</code>为<code>path-name</code>。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">BookComponent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> router: Router</span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">openBookDetail</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">router</span>.<span class="title function_">navigate</span>([&#123;<span class="attr">outlets</span>: &#123;<span class="attr">detail</span>: <span class="string">&#x27;book-detail&#x27;</span>&#125;&#125;]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="添加book-detail组件"><a href="#添加book-detail组件" class="headerlink" title="添加book-detail组件"></a>添加<code>book-detail</code>组件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng generate component book-detail</span><br></pre></td></tr></table></figure>

<p>打开<code>book-detail.component.html</code>，添加如下代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;book-detail&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;book-detail-title&quot;</span>&gt;</span>Book Detail<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;book-detail-body&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Book name: XXX<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Author: XXX<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Price: XXX<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Category: XXX<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Published date: XXX<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Quantity: XXX<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;close-button&quot;</span> (<span class="attr">click</span>)=<span class="string">&quot;closeBookDetail()&quot;</span>&gt;</span>X<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>打开<code>book-detail.component.ts</code>，添加按钮点击事件处理函数：这里将<code>path</code>设置为<code>null</code>，表示关闭对应的组件。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">BookDetailComponent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> router: Router</span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">closeBookDetail</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">router</span>.<span class="title function_">navigate</span>([&#123;<span class="attr">outlets</span>: &#123;<span class="attr">detail</span>: <span class="literal">null</span>&#125;&#125;]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="运行项目"><a href="#运行项目" class="headerlink" title="运行项目"></a>运行项目</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng serve</span><br></pre></td></tr></table></figure>

<p>打开浏览器，访问<code>http://localhost:4200/book</code></p>
<p><img src="/../images/angular-auxiliary-router-book.png" alt="alt text"></p>
<p>点击<code>Book Detail</code>按钮，弹出<code>book-detail</code>组件，此时路由变华为<code>https://localhost:4200/book(detail:book-detail)</code>。</p>
<ul>
<li>detail: 表示辅助路由的名称，定义在<code>outlet</code>属性中。</li>
<li>book-detail: 表示辅助路由的路径。定义在<code>router</code>文件中。</li>
</ul>
<p><img src="/../images/angular-auxiliary-router-book-detail.png" alt="alt text"></p>
<p>点击弹窗上的关闭按钮，关闭<code>book-detail</code>组件，路由恢复为<code>http://localhost:4200/book</code>。</p>
<h2 id="同时显示多个辅助路由。"><a href="#同时显示多个辅助路由。" class="headerlink" title="同时显示多个辅助路由。"></a>同时显示多个辅助路由。</h2><p>添加一个<code>book-list</code>组件，点击<code>Book List</code>按钮时显示<code>book-list</code>弹窗。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng generate component book-list</span><br></pre></td></tr></table></figure>

<p>打开<code>book-list.component.html</code>文件，添加如下代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;book-list&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;book-list-title&quot;</span>&gt;</span>Book List<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;book-list-body&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Book 1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Book 2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Book 3<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Book 4<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;close-button&quot;</span> (<span class="attr">click</span>)=<span class="string">&quot;closeBookList()&quot;</span>&gt;</span>X<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>打开<code>book-list.component.ts</code>文件，添加如下代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">BookListComponent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> router: Router</span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">closeBookList</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">router</span>.<span class="title function_">navigate</span>([&#123;<span class="attr">outlets</span>: &#123;<span class="attr">list</span>: <span class="literal">null</span>&#125;&#125;]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>打开<code>book-list.component.css</code>  添加样式</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.book-list</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">30%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">30%</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">30%</span>, -<span class="number">30%</span>);</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">9</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">background-color</span>: white;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid gray;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">20px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.6</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.close-button</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">40px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>打开<code>book.component.html</code>文件，添加<code>Book List</code>按钮：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>book works!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">&quot;openBookList()&quot;</span>&gt;</span>Book List<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">&quot;openBookDetail()&quot;</span>&gt;</span>Book Detail<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>打开<code>book.component.ts</code>文件，添加按钮点击事件处理函数：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">openBookList</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">router</span>.<span class="title function_">navigate</span>([&#123;<span class="attr">outlets</span>: &#123;<span class="attr">list</span>: <span class="string">&#x27;book-list&#x27;</span>&#125;&#125;]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在<code>app.routes.ts</code>文件中添加路由配置：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">routes</span>: <span class="title class_">Routes</span> = [</span><br><span class="line">  &#123;<span class="attr">path</span>: <span class="string">&#x27;book&#x27;</span>, <span class="attr">component</span>: <span class="title class_">BookComponent</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">path</span>: <span class="string">&#x27;book-list&#x27;</span>, <span class="attr">outlet</span>: <span class="string">&#x27;list&#x27;</span>, <span class="attr">component</span>: <span class="title class_">BookListComponent</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">path</span>: <span class="string">&#x27;book-detail&#x27;</span>, <span class="attr">outlet</span>: <span class="string">&#x27;detail&#x27;</span>, <span class="attr">component</span>: <span class="title class_">BookDetailComponent</span>&#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<p>打开<code>app.component.html</code>文件，添加<code>Book List</code>对应的<code>outlet</code>：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-outlet</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-outlet</span> <span class="attr">name</span>=<span class="string">&quot;detail&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-outlet</span> <span class="attr">name</span>=<span class="string">&quot;list&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>在次运行项目，依次点击<code>Book List</code>和<code>Book Detail</code>按钮，可以同时显示两个弹窗。观察此时路由的变化，注意有多个辅助路由时，按照路由outlet名字的字符串顺序显示，因为detail排在list前面，所以先显示detail，再显示list。无论先点击哪个按钮，路由顺序皆如此。</p>
<p><img src="/../images/angular-auxiliary-router-multiple-routers.png" alt="alt text"></p>
<p><code>http://localhost:4200/book(detail:book-detail//list:book-list)</code></p>
<ul>
<li><code>detail</code>: 表示辅助路由的名称，定义在<code>outlet</code>属性中。</li>
<li><code>book-detail</code>: 表示辅助路由的路径。定义在<code>router</code>文件中。</li>
<li><code>list</code>: 表示辅助路由的名称，定义在<code>outlet</code>属性中。</li>
<li><code>book-list</code>: 表示辅助路由的路径。定义在<code>router</code>文件中。</li>
<li><code>//</code>: 用来分隔多个辅助路由。</li>
</ul>
<h2 id="不更改URL显示辅助路由"><a href="#不更改URL显示辅助路由" class="headerlink" title="不更改URL显示辅助路由"></a>不更改URL显示辅助路由</h2><p>默认情况下，点击按钮后，路由会发生变化，URL会显示辅助路由的路径。如果不想更改URL，可以使用<code>skipLocationChange</code>选项。<br>在<code>book.component.ts</code>文件中，添加按钮点击事件处理函数：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">openBookList</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">router</span>.<span class="title function_">navigate</span>([&#123;<span class="attr">outlets</span>: &#123;<span class="attr">list</span>: <span class="string">&#x27;book-list&#x27;</span>&#125;&#125;], &#123;<span class="attr">skipLocationChange</span>: <span class="literal">true</span>&#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">openBookDetail</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">router</span>.<span class="title function_">navigate</span>([&#123;<span class="attr">outlets</span>: &#123;<span class="attr">detail</span>: <span class="string">&#x27;book-detail&#x27;</span>&#125;&#125;], &#123;<span class="attr">skipLocationChange</span>: <span class="literal">true</span>&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意，如果有多个辅助路由，也要在关闭按钮点击事件处理函数中添加<code>skipLocationChange</code>选项，否则关闭一个弹窗时，另一个弹窗的URL会显示在地址栏中。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">closeBookList</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">router</span>.<span class="title function_">navigate</span>([&#123;<span class="attr">outlets</span>: &#123;<span class="attr">list</span>: <span class="literal">null</span>&#125;&#125;], &#123;<span class="attr">skipLocationChange</span>: <span class="literal">true</span>&#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">closeBookDetail</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">router</span>.<span class="title function_">navigate</span>([&#123;<span class="attr">outlets</span>: &#123;<span class="attr">detail</span>: <span class="literal">null</span>&#125;&#125;], &#123;<span class="attr">skipLocationChange</span>: <span class="literal">true</span>&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>再次点击<code>Book List</code>和<code>Book Detail</code>按钮，可以看到URL没有发生变化。依次关闭两个弹窗，URL仍然保持不变。</p>
<p><img src="/../images/angular-auxiliary-router-no-url-change.png" alt="alt text"></p>
<h2 id="使用routerLink显示辅助路由"><a href="#使用routerLink显示辅助路由" class="headerlink" title="使用routerLink显示辅助路由"></a>使用<code>routerLink</code>显示辅助路由</h2><p>上面的例子中，我们通过点击按钮，并且在按钮事件处理函数中调用<code>navigate</code>方法来显示辅助路由。也可以使用<code>routerLink</code>来显示辅助路由。<br>在<code>app.component.html</code>文件中，使用<code>routerLink</code>显示辅助路由：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> [<span class="attr">routerLink</span>]=<span class="string">&quot;[&#123;outlets: &#123;list: &#x27;book-list&#x27;&#125;&#125;]&quot;</span>&gt;</span>Book List<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> [<span class="attr">routerLink</span>]=<span class="string">&quot;[&#123;outlets: &#123;detail: &#x27;book-detail&#x27;&#125;&#125;]&quot;</span>&gt;</span>Book Detail<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="主路由和辅助路由各自独立"><a href="#主路由和辅助路由各自独立" class="headerlink" title="主路由和辅助路由各自独立"></a>主路由和辅助路由各自独立</h2><p>前面提起过，主路由和辅助路由是平级关系，二者可自由变化，互补影响，比如我们可以在<code>book</code>组件下添加一个子路由<code>book1</code>，然后在<code>book1</code>下再添加子路由<code>book2</code>。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.routers.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">routes</span>: <span class="title class_">Routes</span> = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;book&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">BookComponent</span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;book1&#x27;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="title class_">Book1Component</span>,</span><br><span class="line">        <span class="attr">children</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">path</span>: <span class="string">&#x27;book2&#x27;</span>,</span><br><span class="line">            <span class="attr">component</span>: <span class="title class_">Book2Component</span>,</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- book.component.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>book works!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-outlet</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- book1.component.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>book1 works!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-outlet</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- book2.component.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>book2 works!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>此时点击<code>book-detail</code>按钮，观察路由变化，辅助路由自动append到主路由后面，无论主路由的层级有多深。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">http</span>:<span class="comment">//localhost:4200/book/book1/book2(detail:book-detail)</span></span><br></pre></td></tr></table></figure>

<h2 id="同时显示主路由和辅助路由"><a href="#同时显示主路由和辅助路由" class="headerlink" title="同时显示主路由和辅助路由"></a>同时显示主路由和辅助路由</h2><p>主路由的<code>outlet name</code>是<code>primary</code>，我们只需在routerLink或者navigate函数中指定<code>primary</code>即可。</p>
<p>通过<code>routerLink</code>属性触发(浏览器url：<code>http://localhost:4200/book(detail:book-detail)</code>)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> [<span class="attr">routerLink</span>]=<span class="string">&quot;[&#123;outlets: &#123;primary: &#x27;book&#x27;, detail: &#x27;book-detail&#x27;&#125;&#125;]&quot;</span>&gt;</span>Book and detail<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>通过<code>router.navigate</code>方法触发(浏览器url：<code>http://localhost:4200/book(detail:book-detail)</code>)</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">router</span>.<span class="title function_">navigate</span>([&#123;<span class="attr">outlets</span>: &#123;<span class="attr">primary</span>: <span class="string">&#x27;book&#x27;</span>, <span class="attr">detail</span>: <span class="string">&#x27;book-detail&#x27;</span>&#125;&#125;]);</span><br></pre></td></tr></table></figure>

<p>如果主路由对应多级<code>path</code>，直接指定即可，如下：(浏览器url：<code>http://localhost:4200/book/book1/book2(detail:book-detail)</code>)</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">router</span>.<span class="title function_">navigate</span>([&#123;<span class="attr">outlets</span>: &#123;<span class="attr">primary</span>: <span class="string">&#x27;book/book1/book2&#x27;</span>, <span class="attr">detail</span>: <span class="string">&#x27;book-detail&#x27;</span>&#125;&#125;]);</span><br></pre></td></tr></table></figure>

<h2 id="一次触发多个辅助路由"><a href="#一次触发多个辅助路由" class="headerlink" title="一次触发多个辅助路由"></a>一次触发多个辅助路由</h2><p>上面的例子中我们是依次点击按钮来显示辅助路由的，Angular也支持一次触发多个辅助路由，</p>
<h3 id="使用routerLink"><a href="#使用routerLink" class="headerlink" title="使用routerLink"></a>使用<code>routerLink</code></h3><p>可以在<code>routerLink</code>中同时定义多个辅助路由，在<code>app.component.html</code>文件中，添加如下代码，当我们点击<code>Book List and Details</code>按钮时，将同时显示<code>book-list</code>和<code>book-detail</code>组件。Url也将变为<code>http://localhost:4200/book(detail:book-detail//list:book-list)</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- app.component.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> [<span class="attr">routerLink</span>]=<span class="string">&quot;[&#123;outlets: &#123;list: &#x27;book-list&#x27;, detail: &#x27;book-detail&#x27;&#125;&#125;]&quot;</span>&gt;</span>Book List and Details<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="使用navigate方法"><a href="#使用navigate方法" class="headerlink" title="使用navigate方法"></a>使用<code>navigate</code>方法</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">openBookListAndDetail</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">router</span>.<span class="title function_">navigate</span>([&#123;<span class="attr">outlets</span>: &#123;<span class="attr">list</span>: <span class="string">&#x27;book-list&#x27;</span>, <span class="attr">detail</span>: <span class="string">&#x27;book-detail&#x27;</span>&#125;&#125;]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li>辅助路由的格式：(outletname: path)，比如(list:book-list), <code>list</code>对应<code>outlet name</code>, <code>book-list</code>对应<code>path</code>。</li>
<li>主路由和辅助路由是平级关系，他们的<code>outlet</code>要定义在一个文件中。比如上面例子中book和book-list，book-detail三者都是平级关系，所以他们的<code>outlet</code>都定义在<code>app.component.html</code>文件中。</li>
<li><code>outlet</code>属性中<code>name</code>用来表示辅助路由的名称，不能包含<code>-</code>，不能是字符串<code>primary</code>，否则无法显示。</li>
<li>html文件中如果使用了<code>routerLink</code>，那么同时也要定义<code>outlet</code>，否则无法显示。</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/05/07/angular-component/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Philip Zhang">
      <meta itemprop="description" content="青春都一餉，忍把浮名換了代碼輕狂。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Philip">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/05/07/angular-component/" class="post-title-link" itemprop="url">angular-component</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-05-07 22:15:13" itemprop="dateCreated datePublished" datetime="2024-05-07T22:15:13+08:00">2024-05-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-05-08 10:03:40" itemprop="dateModified" datetime="2024-05-08T10:03:40+08:00">2024-05-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>下面是一个Angular Component的例子：我们可以使用Angular CLI来生成一个Component，比如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng generate component product <span class="comment"># or ng g c product</span></span><br></pre></td></tr></table></figure>

<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@angular/core&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  <span class="attr">selector</span>: <span class="string">&#x27;product&#x27;</span>, <span class="comment">// 选择器</span></span><br><span class="line">  <span class="attr">templateUrl</span>: <span class="string">&#x27;./product.component.html&#x27;</span>, <span class="comment">// 模板</span></span><br><span class="line">  <span class="attr">styleUrls</span>: [<span class="string">&#x27;./product.component.less&#x27;</span>] <span class="comment">// 样式</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">ProductComponent</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>Component（组件）是Angular中的最小单元，通常来说，一个Component包含以下几个部分：</p>
<ol>
<li>选择器</li>
<li>模板</li>
<li>样式</li>
</ol>
<p>这三者中，哪个都不是必须的，但是至少要有模板。</p>
<h2 id="选择器"><a href="#选择器" class="headerlink" title="选择器"></a>选择器</h2><p>选择器是用来引用当前Component的，比如其他组件若想使用Product组件的话，那么可以在模板中使用<code>&lt;product&gt;&lt;/product&gt;</code>标签。选择器是给别人用的，组件本身并不使用自己的选择器。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">product</span>&gt;</span><span class="tag">&lt;/<span class="name">product</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Angular中的选择器是CSS选择器，可以是标签选择器、类选择器、属性选择器等等, 一般来说, 组件通常使用标签选择器,指令通常使用属性选择器, 他类型的选择器使用较少, 但是也是可以的。比如使用类选择器来实现<code>Product</code>组件：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  <span class="attr">selector</span>: <span class="string">&#x27;.product&#x27;</span>,</span><br><span class="line">  <span class="attr">templateUrl</span>: <span class="string">&#x27;./product.component.html&#x27;</span>,</span><br><span class="line">  <span class="attr">styleUrls</span>: [<span class="string">&#x27;./product.component.less&#x27;</span>]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;product&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>运行效果是一样的, 选择器本质是<code>Directive</code>上的属性,而<code>Component</code>是<code>Directive</code>的一个特例, 所以<code>Component</code>也可以使用选择器。关于选择器的详情,请看<a target="_blank" rel="noopener" href="https://angular.io/api/core/Directive#selector">这里</a></p>
<p><strong>注意：</strong> 选择器不是必须的，一个组件可以没有选择器，这样的组件只能通过路由来访问，或者动态加载。</p>
<h2 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h2><p>模板是Component的视图，可以是HTML文件模板（比如上面的<code>Product</code>组件），也可以是内联模板。比如：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  <span class="attr">selector</span>: <span class="string">&#x27;product&#x27;</span>,</span><br><span class="line">  <span class="attr">template</span>: <span class="string">&#x27;&lt;div&gt;Product works&lt;/div&gt;&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>这样的话，就不需要<code>product.component.html</code>文件了。通常来说，如果模板的内容较多，还是存放到文件中比较好，这样可以方便维护。</p>
<h2 id="样式"><a href="#样式" class="headerlink" title="样式"></a>样式</h2><p>样式是Component的样式，Angular支持多文件样式，单文件样式以及内联样式：</p>
<h3 id="多文件样式"><a href="#多文件样式" class="headerlink" title="多文件样式"></a>多文件样式</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  <span class="attr">selector</span>: <span class="string">&#x27;product&#x27;</span>,</span><br><span class="line">  <span class="attr">templateUrl</span>: <span class="string">&#x27;./product.component.html&#x27;</span>,</span><br><span class="line">  <span class="attr">styleUrls</span>: [<span class="string">&#x27;./product.component.less&#x27;</span>, <span class="string">&#x27;./product.item.css&#x27;</span>]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="单文件样式"><a href="#单文件样式" class="headerlink" title="单文件样式"></a>单文件样式</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  <span class="attr">selector</span>: <span class="string">&#x27;product&#x27;</span>,</span><br><span class="line">  <span class="attr">templateUrl</span>: <span class="string">&#x27;./product.component.html&#x27;</span>,</span><br><span class="line">  <span class="attr">styleUrl</span>: <span class="string">&#x27;./product.component.less&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="内联样式"><a href="#内联样式" class="headerlink" title="内联样式"></a>内联样式</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  <span class="attr">selector</span>: <span class="string">&#x27;product&#x27;</span>,</span><br><span class="line">  <span class="attr">templateUrl</span>: <span class="string">&#x27;./product.component.html&#x27;</span>,</span><br><span class="line">  <span class="attr">styles</span>: [<span class="string">&#x27;div &#123; color: red; &#125;&#x27;</span>]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>这样的话，就不需要<code>product.component.less</code>文件了。通常来说，如果样式较多，还是存放到文件中比较好, 样式是依附于模板的，如果一个组件没有模板，那么也就没有样式。</p>
<p>对于一个Component来说：</p>
<ol>
<li>只有<code>component.ts</code>文件是必须的。</li>
<li><code>component.html</code>和<code>component.less</code>是可选的, 可以使用内联模板和内联样式代替，也可以干脆没有。</li>
<li>可以没有<code>selector</code>(选择器)，但是这样的Component只能通过路由来访问，或者动态加载。</li>
</ol>
<p>一个极简组件：这个组件什么也不显示，没有样式，也没有选择器。只能在路由中使用。可以在ngOnInit中添加一些逻辑，比如用来弹出popup等。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  <span class="attr">template</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/05/06/react-analyze-bundle-size/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Philip Zhang">
      <meta itemprop="description" content="青春都一餉，忍把浮名換了代碼輕狂。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Philip">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/05/06/react-analyze-bundle-size/" class="post-title-link" itemprop="url">react-analyze-bundle-size</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2024-05-06 21:57:18 / Modified: 22:02:12" itemprop="dateCreated datePublished" datetime="2024-05-06T21:57:18+08:00">2024-05-06</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Use source map explorer to analyze the bundle size of a React app.</p>
<h2 id="Steps"><a href="#Steps" class="headerlink" title="Steps"></a>Steps</h2><h3 id="1-Install-source-map-explorer"><a href="#1-Install-source-map-explorer" class="headerlink" title="1. Install source-map-explorer"></a>1. Install source-map-explorer</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install -g source-map-explorer</span><br><span class="line">yarn global add source-map-explorer</span><br></pre></td></tr></table></figure>

<h3 id="Turn-on-source-map"><a href="#Turn-on-source-map" class="headerlink" title="Turn on source map"></a>Turn on source map</h3><p>In <code>package.json</code>, add the following line to the <code>build</code> script:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;GENERATE_SOURCEMAP=true react-scripts build&quot;</span></span><br></pre></td></tr></table></figure>

<p>If this doesn’t work, open environment config file <code>.env.production</code> and add the following line:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GENERATE_SOURCEMAP=<span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>Don’t forget to set it to false after you finish analyzing the bundle size. source map should never be enabled in production.</p>
<h3 id="2-Build-the-React-app"><a href="#2-Build-the-React-app" class="headerlink" title="2. Build the React app"></a>2. Build the React app</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br><span class="line">yarn build</span><br></pre></td></tr></table></figure>

<h3 id="3-Analyze-the-bundle-size"><a href="#3-Analyze-the-bundle-size" class="headerlink" title="3. Analyze the bundle size"></a>3. Analyze the bundle size</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source-map-explorer build/static/js/*.js</span><br></pre></td></tr></table></figure>
<p>The output will show you the size of each file in the bundle, and the size of each dependency.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Philip Zhang</p>
  <div class="site-description" itemprop="description">青春都一餉，忍把浮名換了代碼輕狂。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">113</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">169</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Philip Zhang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
